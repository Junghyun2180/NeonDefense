# ğŸš€ ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ

## ğŸ” í˜„ì¬ ë¬¸ì œ
- **ì¦ìƒ**: Stage 10 Wave 5ì—ì„œ í”„ë ˆì„ ë“œë ì‹¬ê°
- **ì›ì¸ ì¶”ì •**:
  1. ë§ì€ ìˆ˜ì˜ ì  (50+ ë§ˆë¦¬)
  2. ë§ì€ ìˆ˜ì˜ íƒ€ì›Œ (10~15ê°œ)
  3. ë§ì€ ìˆ˜ì˜ íˆ¬ì‚¬ì²´ (ë™ì‹œì— ìˆ˜ì‹­ ê°œ)
  4. ë§¤ í”„ë ˆì„ë§ˆë‹¤ ì¶©ëŒ ê°ì§€, ê±°ë¦¬ ê³„ì‚° ë“±

## ğŸ“Š ì„±ëŠ¥ ë³‘ëª© ì§€ì 

### 1. ê²Œì„ ë£¨í”„ (game-engine.js)
```javascript
// ë§¤ 16msë§ˆë‹¤ ì‹¤í–‰ (60 FPS ëª©í‘œ)
- gameTick() í•¨ìˆ˜ì—ì„œ:
  - ëª¨ë“  ì  ì´ë™ ë° ìƒíƒœ ì—…ë°ì´íŠ¸
  - ëª¨ë“  íƒ€ì›Œ íƒ€ê²Ÿ ì°¾ê¸° ë° ê³µê²©
  - ëª¨ë“  íˆ¬ì‚¬ì²´ ì´ë™ ë° ì¶©ëŒ ê°ì§€
  - ëª¨ë“  ì´í™íŠ¸ ì²˜ë¦¬
```

### 2. íƒ€ì›Œ íƒ€ê²ŸíŒ… (tower.js)
```javascript
// ê° íƒ€ì›Œë§ˆë‹¤ ë§¤ í”„ë ˆì„:
findTarget(tower, enemies) {
  enemies.forEach(enemy => {
    // ê±°ë¦¬ ê³„ì‚° (Math.sqrt)
    const dist = Math.sqrt(...);
    if (dist < tower.range) {
      // íƒ€ê²Ÿ í›„ë³´ ì¶”ê°€
    }
  });
}
```

**ë¬¸ì œì **:
- íƒ€ì›Œ 10ê°œ Ã— ì  50ë§ˆë¦¬ = **500ë²ˆì˜ ê±°ë¦¬ ê³„ì‚°/í”„ë ˆì„**
- 60 FPS = **ì´ˆë‹¹ 30,000ë²ˆ ê³„ì‚°**

### 3. íˆ¬ì‚¬ì²´ ì¶©ëŒ ê°ì§€ (game-engine.js)
```javascript
// ê° íˆ¬ì‚¬ì²´ë§ˆë‹¤:
projectiles.forEach(proj => {
  enemies.forEach(enemy => {
    // ì¶©ëŒ ì²´í¬
    const dist = Math.sqrt(...);
  });
});
```

**ë¬¸ì œì **:
- íˆ¬ì‚¬ì²´ 20ê°œ Ã— ì  50ë§ˆë¦¬ = **1,000ë²ˆì˜ ì¶©ëŒ ì²´í¬/í”„ë ˆì„**

---

## âœ… ìµœì í™” ë°©ì•ˆ

### ì¦‰ì‹œ ì ìš© ê°€ëŠ¥ (Low-Hanging Fruit)

#### 1. ê±°ë¦¬ ê³„ì‚° ìµœì í™”
```javascript
// âŒ Before (ëŠë¦¼)
const dist = Math.sqrt((x2-x1)**2 + (y2-y1)**2);
if (dist < range) { ... }

// âœ… After (ë¹ ë¦„ - ì œê³±ê·¼ ìƒëµ)
const distSq = (x2-x1)**2 + (y2-y1)**2;
if (distSq < range**2) { ... }
```

**íš¨ê³¼**: Math.sqrt() ì œê±°ë¡œ **20~30% ì„±ëŠ¥ í–¥ìƒ**

#### 2. íƒ€ê²ŸíŒ… ì£¼ê¸° ì¡°ì •
```javascript
// âŒ Before: ë§¤ í”„ë ˆì„ íƒ€ê²Ÿ ì¬íƒìƒ‰ (16ms)
// âœ… After: 3í”„ë ˆì„ë§ˆë‹¤ íƒ€ê²Ÿ ì¬íƒìƒ‰ (48ms)

if (tower.targetRefreshCounter++ % 3 === 0) {
  tower.target = findTarget(tower, enemies);
}
```

**íš¨ê³¼**: íƒ€ê²ŸíŒ… ì—°ì‚° **66% ê°ì†Œ**

#### 3. íˆ¬ì‚¬ì²´ í’€ë§ (Object Pooling)
```javascript
// âŒ Before: ë§¤ë²ˆ ìƒˆ ê°ì²´ ìƒì„±
const proj = { x, y, ... };

// âœ… After: ì¬ì‚¬ìš©
const proj = projectilePool.get();
proj.reset(x, y, ...);
```

**íš¨ê³¼**: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ë¶€ë‹´ ê°ì†Œ

#### 4. ì  ì œê±° ìµœì í™”
```javascript
// âŒ Before: filter()ë¡œ ìƒˆ ë°°ì—´ ìƒì„±
enemies = enemies.filter(e => e.health > 0);

// âœ… After: splice()ë¡œ ì œìë¦¬ ì œê±°
for (let i = enemies.length - 1; i >= 0; i--) {
  if (enemies[i].health <= 0) {
    enemies.splice(i, 1);
  }
}
```

**íš¨ê³¼**: ë©”ëª¨ë¦¬ í• ë‹¹ ê°ì†Œ

---

### ì¤‘ê¸‰ ìµœì í™” (ë” í° íš¨ê³¼)

#### 5. ê³µê°„ ë¶„í•  (Spatial Partitioning)
í˜„ì¬: ëª¨ë“  íƒ€ì›Œê°€ ëª¨ë“  ì ì„ ê²€ì‚¬ (O(nÂ²))

ê°œì„ : ê·¸ë¦¬ë“œë¡œ ë‚˜ëˆ„ì–´ ê°€ê¹Œìš´ ì ë§Œ ê²€ì‚¬ (O(n))

```javascript
// ë§µì„ 10x10 ê·¸ë¦¬ë“œë¡œ ë¶„í• 
const grid = new SpatialGrid(10, 10);

// ì ì„ ê·¸ë¦¬ë“œì— ë“±ë¡
enemies.forEach(e => grid.add(e));

// íƒ€ì›ŒëŠ” ìê¸° ì£¼ë³€ ì…€ë§Œ ê²€ì‚¬
const nearbyEnemies = grid.getNearby(tower.x, tower.y, tower.range);
```

**íš¨ê³¼**: íƒ€ê²ŸíŒ… ì—°ì‚° **70~80% ê°ì†Œ**

#### 6. ë Œë”ë§ ìµœì í™”
```javascript
// âŒ Before: ëª¨ë“  ê°ì²´ ë§¤ í”„ë ˆì„ ë Œë”
// âœ… After: í™”ë©´ ë°– ê°ì²´ ìŠ¤í‚µ

if (isInViewport(obj)) {
  render(obj);
}
```

---

### ê³ ê¸‰ ìµœì í™” (ëŒ€ê·œëª¨ ë¦¬íŒ©í† ë§)

#### 7. Web Workerë¡œ ê²Œì„ ë¡œì§ ë¶„ë¦¬
- ë©”ì¸ ìŠ¤ë ˆë“œ: UI ë Œë”ë§ë§Œ
- Worker ìŠ¤ë ˆë“œ: ê²Œì„ ë¡œì§ (ì¶©ëŒ, íƒ€ê²ŸíŒ… ë“±)

#### 8. Canvas ë Œë”ë§ìœ¼ë¡œ ì „í™˜
- React DOM ì—…ë°ì´íŠ¸ ì˜¤ë²„í—¤ë“œ ì œê±°
- ì§ì ‘ Canvasì— ê·¸ë¦¬ê¸°

---

## ğŸ› ï¸ êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ì¦‰ì‹œ ì ìš© (30ë¶„)
1. âœ… ê±°ë¦¬ ê³„ì‚° ìµœì í™” (distSq ì‚¬ìš©)
2. âœ… íƒ€ê²ŸíŒ… ì£¼ê¸° ì¡°ì • (3í”„ë ˆì„ë§ˆë‹¤)

**ì˜ˆìƒ íš¨ê³¼**: 30~40% ì„±ëŠ¥ í–¥ìƒ

### Phase 2: ë‹¨ê¸° (2ì‹œê°„)
3. ì  ì œê±° ìµœì í™”
4. íˆ¬ì‚¬ì²´ í’€ë§

**ì˜ˆìƒ íš¨ê³¼**: ì¶”ê°€ 20% í–¥ìƒ

### Phase 3: ì¤‘ê¸° (1ì¼)
5. ê³µê°„ ë¶„í•  (Spatial Grid)

**ì˜ˆìƒ íš¨ê³¼**: ì¶”ê°€ 50% í–¥ìƒ (ì´ 2ë°°)

### Phase 4: ì¥ê¸° (1ì£¼)
6. ë Œë”ë§ ìµœì í™”
7. Web Worker (í•„ìš”ì‹œ)

---

## ğŸ“ˆ ì¸¡ì • ë°©ë²•

### ë¸Œë¼ìš°ì € Performance í”„ë¡œíŒŒì¼ë§
1. F12 â†’ Performance íƒ­
2. Record ì‹œì‘
3. ê²Œì„ í”Œë ˆì´ (Stage 10)
4. Record ì¤‘ì§€
5. ë³‘ëª© í•¨ìˆ˜ í™•ì¸

### FPS ì¸¡ì •
```javascript
// ì½˜ì†”ì— ì…ë ¥
let lastTime = performance.now();
let fps = 0;
setInterval(() => {
  const now = performance.now();
  fps = 1000 / (now - lastTime);
  lastTime = now;
  console.log('FPS:', fps.toFixed(1));
}, 1000);
```

**ëª©í‘œ**: Stage 10ì—ì„œ **50+ FPS** ìœ ì§€

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **Phase 1 ìµœì í™” ì ìš©** (distSq, íƒ€ê²ŸíŒ… ì£¼ê¸°)
2. **ì¸¡ì •** (FPS ê°œì„  í™•ì¸)
3. **ë¶€ì¡±í•˜ë©´ Phase 2 ì§„í–‰**

---

**ì‘ì„±ì¼**: 2026-02-05
**í˜„ì¬ FPS**: ~30 FPS (Stage 10 Wave 5)
**ëª©í‘œ FPS**: 50+ FPS
